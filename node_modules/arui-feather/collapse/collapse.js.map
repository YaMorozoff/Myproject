{"version":3,"sources":["collapse/collapse.tsx"],"names":[],"mappings":"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","file":"collapse.js","sourcesContent":["/* This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport { createCn } from 'bem-react-classname';\nimport { withTheme } from '../cn';\n\nimport IconArrowDown from '../icon/ui/arrow-down';\nimport IconArrowUp from '../icon/ui/arrow-up';\nimport Link from '../link/link';\nimport { ResizeSensor } from '../resize-sensor/resize-sensor';\n\nexport type CollapseProps = {\n    /**\n     * Управление `expanded` состоянием компонента\n     * */\n    isExpanded?: boolean;\n\n    /**\n     * Текст ссылки в `expanded` состоянии\n     * */\n    collapsedLabel?: string;\n\n    /**\n     * Текст ссылки в `collapsed` состоянии\n     * */\n    expandedLabel?: string;\n\n    /**\n     * Дочерние элементы `Collapse`\n     */\n    children?: React.ReactNode;\n\n    /**\n     * Тема компонента\n     */\n    theme?: 'alfa-on-color' | 'alfa-on-white';\n\n    /**\n     * Дополнительный класс\n     */\n    className?: string;\n\n    /**\n     * Идентификатор компонента в DOM\n     */\n    id?: string;\n\n    /**\n     * Обработчик смены состояний `expanded/collapsed`\n     */\n    onExpandedChange?: (isExpanded?: boolean) => void;\n\n    /**\n     * Идентификатор для систем автоматизированного тестирования\n     */\n    'data-test-id'?: string;\n};\n\n/**\n * Компонент «подката» позволяет спрятать кусок текста за ссылку «Еще...».\n */\nexport class Collapse extends React.PureComponent<CollapseProps> {\n    protected cn = createCn('collapse');\n\n    static defaultProps: Partial<CollapseProps> = {\n        expandedLabel: 'Collapse',\n        collapsedLabel: 'Expand',\n    };\n\n    state = {\n        isExpanded: false,\n    };\n\n    private content: HTMLDivElement;\n\n    private contentCase: HTMLDivElement;\n\n    componentDidMount() {\n        this.updateContentHeight();\n    }\n\n    componentDidUpdate() {\n        this.updateContentHeight();\n    }\n\n    render() {\n        let ToggledIcon;\n        const expanded = this.props.isExpanded === undefined ? this.state.isExpanded : this.props.isExpanded;\n\n        switch (expanded) {\n        case true: ToggledIcon = IconArrowUp; break;\n        case false: ToggledIcon = IconArrowDown; break;\n        }\n\n        return (\n            <div\n                className={ this.cn({\n                    expanded,\n                }) }\n                id={ this.props.id }\n                data-test-id={ this.props['data-test-id'] }\n            >\n                <div\n                    ref={ (content) => {\n                        this.content = content;\n                    } }\n                    className={ this.cn('content') }\n                >\n                    <div ref={ (contentCase) => {\n                        this.contentCase = contentCase;\n                    } }\n                    >\n                        { this.props.children }\n                    </div>\n                    <ResizeSensor onResize={ this.updateContentHeight } />\n                </div>\n                <Link\n                    className={ this.cn('link') }\n                    pseudo={ true }\n                    icon={\n                        <ToggledIcon size=\"s\" />\n                    }\n                    iconPosition=\"right\"\n                    onClick={ this.handleExpandedChange }\n                    text={\n                        expanded\n                            ? this.props.expandedLabel\n                            : this.props.collapsedLabel\n                    }\n                />\n            </div>\n        );\n    }\n\n    private handleExpandedChange = () => {\n        // eslint-disable-next-line react/no-access-state-in-setstate\n        const newExpandedValue = this.props.isExpanded === undefined ? !this.state.isExpanded : !this.props.isExpanded;\n\n        this.setState({\n            isExpanded: newExpandedValue,\n        });\n\n        if (this.props.onExpandedChange) {\n            this.props.onExpandedChange(newExpandedValue);\n        }\n    };\n\n    private updateContentHeight = () => {\n        const expanded = this.props.isExpanded === undefined ? this.state.isExpanded : this.props.isExpanded;\n\n        let contentHeight;\n\n        if (expanded) {\n            contentHeight = this.contentCase.offsetHeight;\n        } else {\n            contentHeight = 0;\n        }\n\n        if (this.content) {\n            this.content.style.height = `${contentHeight}px`;\n        }\n    }\n}\n\nexport default withTheme<CollapseProps, Collapse>(Collapse);\n"]}