{"version":3,"sources":["popup/popup.tsx"],"names":[],"mappings":"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","file":"popup.js","sourcesContent":["/* This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\n/* eslint-disable max-len */\n\nimport debounce from 'lodash.debounce';\nimport React from 'react';\nimport Type, { ValidationMap } from 'prop-types';\nimport ReactDOM from 'react-dom';\nimport { createCn } from 'bem-react-classname';\nimport { withTheme } from '../cn';\nimport { ResizeSensor } from '../resize-sensor/resize-sensor';\n\nimport { calcBestDrawingParams, calcTargetDimensions, calcFitContainerDimensions } from './calc-drawing-params';\nimport { HtmlElement } from '../lib/prop-types';\nimport { isNodeOutsideElement } from '../lib/window';\nimport performance from '../performance';\n\n// TODO: решить че с этим делать потому что вроде как отдельная структура не нужна\n/**\n * @typedef {Object} Point\n * @property {Number} left Координата по оси x\n * @property {Number} top Координата по оси y\n */\n\n/**\n * @typedef {Object} PopupOffsetCollection\n * @property {Number} main Смещение в пикселях всплывающего окна относительно основного направления\n * @property {Number} second Смещение в пикселях всплывающего окна относительно второстепенного направления\n * @property {Number} viewport Минимально допустимое смещение в пикселях всплывающего окна от края окна браузера\n */\n\n/**\n * @typedef {Object} PopupHash\n * @property {Array.<String>} directions Список возмножных расположений попапа\n * @property {String} bestDirection Приоритетное расположение\n * @property {Boolean} isHeightAdaptive Подстраивается ли высота попапа под край окна\n * @property {Boolean} isHeightAvailable Занимает ли попап всю возможную высоту\n * @property {Boolean} isTargetAnchor Привязан ли попап к другому элементу\n * @property {Boolean} isHaveTooltip Имеет ли попап тип \"tooltip\"\n * @property {Number} width Ширина попапа\n * @property {Number} height Высота попапа\n * @property {Number} contentWidth Ширина контента в попапе\n * @property {Number} contentHeight Высота контента в попапе\n * @property {PopupOffsetCollection} offset Список смещений попапа\n * @property {Point} targetPosition Координаты точки привязки попапа\n * @property {HTMLElement} targetAnchor Объект элемента, к которому привязан попап, в DOM дереве\n */\n\nexport type PopupDirectionsFieldType = 'anchor' | 'top-left' | 'top-center' | 'top-right' | 'left-top' | 'left-center' | 'left-bottom' | 'right-top' | 'right-center' | 'right-bottom' | 'bottom-left' | 'bottom-center' | 'bottom-right';\n\nexport type PopupProps = {\n\n    /**\n     * Дополнительный класс\n     */\n    className?: string;\n\n    /**\n     * Идентификатор компонента в DOM\n     */\n    id?: string;\n\n    /**\n     * Дочерние элементы `Popup`\n     */\n    children?: React.ReactNode;\n\n    /**\n     * Тип попапа\n     */\n    type?: 'default' | 'tooltip';\n\n    /**\n     * Подстраивание высоты попапа под край окна ('adaptive'), занятие попапом всей возможной высоты ('available'), 'default'\n     */\n    height?: 'default' | 'available' | 'adaptive';\n\n    /**\n     * Только для target='anchor', расположение (в порядке приоритета) относительно точки открытия. Первым указывается главное направление, через дефис - второстепенное направление\n     */\n    directions?: readonly PopupDirectionsFieldType[];\n\n    /**\n     * Привязка компонента к другому элементу на странице, или его расположение независимо от остальных: 'anchor', 'position', 'screen'\n     */\n    target?: 'anchor' | 'position' | 'screen';\n\n    /**\n     * Только для target='anchor'. Смещение в пикселях всплывающего окна относительно основного направления\n     */\n    mainOffset?: number;\n\n    /**\n     * Только для target='anchor'. Смещение в пикселях всплывающего окна относительно второстепенного направления\n     */\n    secondaryOffset?: number;\n\n    /**\n     * Только для target='anchor'. Минимально допустимое смещение в пикселях всплывающего окна от края его контейнера\n     */\n    fitContaiterOffset?: number;\n\n    /**\n     * Управление видимостью компонента\n     */\n    visible?: boolean;\n\n    /**\n     * Управление выставлением модификатора для добавления внутренних отступов в стилях\n     */\n    padded?: boolean;\n\n    /**\n     * Элемент закреплённого заголовка для компонента\n     */\n    header?: React.ReactNode;\n\n    /**\n     * Размер компонента\n     */\n    size?: 's' | 'm' | 'l' | 'xl';\n\n    /**\n     * Тема компонента\n     */\n    theme?: 'alfa-on-color' | 'alfa-on-white';\n\n    /**\n     * Обработчик события наведения курсора на попап\n     */\n    onMouseEnter?: (event?: React.MouseEvent<any>) => void;\n\n    /**\n     * Обработчик события снятия курсора с попапа\n     */\n    onMouseLeave?: (event?: React.MouseEvent<any>) => void;\n\n    /**\n     * Обработчик клика вне компонента\n     */\n    onClickOutside?: (event?: React.MouseEvent<any>) => void;\n\n    /**\n     * Минимальная ширина попапа\n     */\n    minWidth?: number;\n\n    /**\n     * Максимальная ширина попапа\n     */\n    maxWidth?: number;\n\n    /**\n     * Максимальная высота попапа\n     */\n    maxHeight?: number;\n\n    /**\n     * Указатель на родительский элемент\n     */\n    for?: string;\n\n    /**\n     * Идентификатор для систем автоматизированного тестирования\n     */\n    'data-test-id'?: string;\n};\n\ntype PopupState = {\n    direction: any;\n    hasScrollbar: boolean;\n    receivedContainer: boolean;\n    styles: React.CSSProperties;\n    topGradientStyles: React.CSSProperties;\n    bottomGradientStyles: React.CSSProperties;\n    canUseDOM: boolean;\n    needRedrawAfterMount: boolean;\n};\n\nexport const popupContextTypes: ValidationMap<unknown> = {\n    isInCustomContainer: Type.bool,\n    renderContainerElement: HtmlElement,\n    positioningContainerElement: HtmlElement,\n};\n\n/**\n * Компонент popup'а.\n */\n@performance(true)\nexport class Popup extends React.Component<PopupProps, PopupState> {\n    protected cn = createCn('popup');\n\n    static defaultProps: Partial<PopupProps> = {\n        visible: false,\n        padded: true,\n        secondaryOffset: 0,\n        fitContaiterOffset: 0,\n        target: 'anchor',\n        size: 's',\n    };\n\n    static contextTypes = popupContextTypes;\n\n    state = {\n        direction: null,\n        hasScrollbar: false,\n        receivedContainer: false,\n        styles: {\n            top: 0,\n            left: 0,\n            height: 'auto',\n        },\n        topGradientStyles: {\n            width: '100%',\n        },\n        bottomGradientStyles: {\n            width: '100%',\n        },\n        canUseDOM: false,\n        /*\n         * Переменная для отложенного вызова функции redraw(),\n         * которая будет вызвана после вызова componentDidMount().\n         */\n        needRedrawAfterMount: false,\n    };\n\n    private anchor = null;\n\n    private clickEventBindTimeout = null;\n\n    private domElemPopup = null;\n\n    private domElemPopupInner: HTMLElement = null;\n\n    private domElemPopupContent = null;\n\n    private isWindowClickBinded = false;\n\n    private position = null;\n\n    private popup;\n\n    private inner;\n\n    private content;\n\n    private handleWindowResize = debounce(() => {\n        if (this.isPropsToPositionCorrect()) {\n            this.redraw();\n        }\n    }, 200);\n\n    // eslint-disable-next-line camelcase\n    UNSAFE_componentWillMount() {\n        if (\n            this.context.isInCustomContainer\n            && this.context.renderContainerElement\n            && this.context.positioningContainerElement\n        ) {\n            this.setState({\n                receivedContainer: true,\n            });\n        }\n    }\n\n    componentDidMount() {\n        if (this.props.onClickOutside) {\n            this.ensureClickEvent();\n        }\n\n        if (this.inner && (this.props.height === 'adaptive' || this.props.target === 'screen')) {\n            this.setGradientStyles();\n        }\n\n        window.addEventListener('resize', this.handleWindowResize);\n\n        /* eslint-disable react/no-did-mount-set-state */\n        this.setState(\n            {\n                canUseDOM: true,\n            },\n            () => {\n                if (this.state.needRedrawAfterMount) {\n                    this.redraw();\n                }\n            },\n        );\n        /* eslint-enable */\n    }\n\n    // eslint-disable-next-line camelcase\n    UNSAFE_componentWillReceiveProps(nextProps, nextContext) {\n        if (\n            !this.state.receivedContainer\n            && nextContext.renderContainerElement\n            && nextContext.positioningContainerElement\n        ) {\n            this.setState(\n                {\n                    receivedContainer: true,\n                },\n                () => {\n                    if (this.props.visible) {\n                        this.redraw();\n                    }\n                },\n            );\n\n            return;\n        }\n\n        if (nextProps.visible !== this.props.visible) {\n            this.redraw();\n        }\n    }\n\n    componentDidUpdate(prevProps) {\n        if (this.props.onClickOutside) {\n            if (prevProps.onClickOutside !== this.props.onClickOutside) {\n                this.ensureClickEvent();\n            } else if (prevProps.visible !== this.props.visible) {\n                this.ensureClickEvent(!this.props.visible);\n            }\n        }\n    }\n\n    componentWillUnmount() {\n        if (this.props.onClickOutside) {\n            this.ensureClickEvent(true);\n        }\n\n        // Cancel debouncing to avoid `this.setState()` invocation in unmounted component state\n        this.handleWindowResize.cancel();\n        window.removeEventListener('resize', this.handleWindowResize);\n    }\n\n    render() {\n        if (!this.state.canUseDOM || !this.isContainerReady()) {\n            return null;\n        }\n\n        const template = (\n            <div\n                ref={ (popup) => {\n                    this.popup = popup;\n                } }\n                data-for={ this.props.for }\n                className={ this.cn({\n                    direction: this.state.direction,\n                    type: this.props.target === 'anchor' && this.props.type === 'tooltip' && this.props.type,\n                    target: this.props.target,\n                    size: this.props.size,\n                    visible: this.props.visible,\n                    height: this.props.height,\n                    padded: this.props.padded,\n                    overflow: !!this.props.maxHeight,\n                }) }\n                id={ this.props.id }\n                style={ {\n                    ...this.state.styles,\n                    minWidth: this.getMinWidth(),\n                    maxWidth: this.getMaxWidth(),\n                    maxHeight: this.getMaxHeight(),\n                } }\n                onMouseEnter={ this.handleMouseEnter }\n                onMouseLeave={ this.handleMouseLeave }\n                data-test-id={ this.props['data-test-id'] }\n            >\n                <div className={ this.cn('container') }>\n                    { this.props.header && <div className={ this.cn('header') }>{ this.props.header }</div> }\n                    <div\n                        ref={ (inner) => {\n                            this.inner = inner;\n                        } }\n                        className={ this.cn('inner') }\n                        onScroll={ this.handleInnerScroll }\n                    >\n                        <div\n                            className={ this.cn('content') }\n                            ref={ (content) => {\n                                this.content = content;\n                            } }\n                        >\n                            { this.props.children }\n                            <ResizeSensor onResize={ this.handleResize } />\n                        </div>\n                    </div>\n                    { this.state.hasScrollbar && (\n                        <div>\n                            <div className={ this.cn('gradient', { top: true }) } style={ this.state.topGradientStyles } />\n                            <div\n                                className={ this.cn('gradient', { bottom: true }) }\n                                style={ this.state.bottomGradientStyles }\n                            />\n                        </div>\n                    ) }\n                </div>\n            </div>\n        );\n\n        return ReactDOM.createPortal(template, this.getRenderContainer());\n    }\n\n    private handleInnerScroll = (event) => {\n        const { scrollTop, offsetHeight, scrollHeight } = event.target;\n        const isTopReached = Math.round(scrollTop) === 0;\n        const isBottomReached = Math.round(scrollTop) + offsetHeight === scrollHeight;\n\n        if (this.props.height === 'adaptive' || this.props.target === 'screen') {\n            const topGradientStyles: {\n                width: string;\n                height?: number;\n            } = {\n                // eslint-disable-next-line react/no-access-state-in-setstate\n                width: this.state.topGradientStyles.width,\n            };\n            const bottomGradientStyles: {\n                width: string;\n                height?: number;\n            } = {\n                // eslint-disable-next-line react/no-access-state-in-setstate\n                width: this.state.bottomGradientStyles.width,\n            };\n\n            if (isTopReached) {\n                topGradientStyles.height = 0;\n            }\n\n            if (isBottomReached) {\n                bottomGradientStyles.height = 0;\n            }\n\n            this.setState({\n                topGradientStyles,\n                bottomGradientStyles,\n            });\n        }\n    };\n\n    private handleMouseEnter = (event) => {\n        if (this.props.onMouseEnter) {\n            this.props.onMouseEnter(event);\n        }\n    };\n\n    private handleMouseLeave = (event) => {\n        if (this.props.onMouseLeave) {\n            this.props.onMouseLeave(event);\n        }\n    };\n\n    private handleWindowClick = (event) => {\n        if (this.props.onClickOutside && !!this.domElemPopup && isNodeOutsideElement(event.target, this.domElemPopup)) {\n            this.props.onClickOutside(event);\n        }\n    };\n\n    private handleResize = () => {\n        if (!this.props.visible) {\n            return;\n        }\n\n        this.redraw();\n    };\n\n    /**\n     * Задает элемент, к которому будет привязан popup.\n     * @param target Элемент, к которому будет привязан popup\n     */\n    public setTarget(target: HTMLElement) {\n        if (this.anchor === target) {\n            return;\n        }\n\n        this.anchor = target;\n        this.redraw();\n    }\n\n    /**\n     * Задает положение popup.\n     * @param left x-coordinate\n     * @param top y-coordinate\n     */\n    public setPosition(left: number, top: number) {\n        this.position = { left, top };\n        this.redraw();\n    }\n\n    /**\n     * Возвращает внутренний DOM узел.\n     */\n    public getInnerNode() {\n        return this.domElemPopupInner;\n    }\n\n    /**\n     * Возвращает контейнер, в котором отрендерится попап.\n     */\n    private getRenderContainer(): HTMLElement {\n        if (!this.context.isInCustomContainer) {\n            return document.body;\n        }\n\n        return this.context.renderContainerElement;\n    }\n\n    /**\n     * Возвращает контейнер, внутрь которого надо вписать элемент.\n     */\n    private getPositioningContainer(): HTMLElement {\n        if (!this.context.isInCustomContainer) {\n            return null;\n        }\n\n        return this.context.positioningContainerElement;\n    }\n\n    /**\n     * Возвращает `true`, если контейнер, в котором должен быть отрисован\n     * `Popup` уже находится в DOM. Для `Popup` без кастомного контейнера\n     * роль контейнера выполняет `document.body` и этот для них этот метод\n     * всегда вернете `true`.\n     */\n    private isContainerReady() {\n        if (!this.context.isInCustomContainer) {\n            return true;\n        }\n\n        return this.context.isInCustomContainer && this.state.receivedContainer;\n    }\n\n    /**\n     * Возвращает `true`, если все необходимые для расчета положения `Popup`\n     * внешние props заданы.\n     */\n    isPropsToPositionCorrect(): boolean {\n        return (\n            (this.props.target === 'anchor' && this.anchor)\n            || (this.props.target === 'position' && this.position)\n            || this.props.target === 'screen'\n        );\n    }\n\n    private redraw = () => {\n        /*\n         * Если функция redraw() была вызвана до componentDidMount,\n         * то нужно отложить её вызов до момента,\n         * когда this.state.canUseDOM будет равен значению true.\n         *\n         * Это сделано для того, чтобы redraw() не вызывалась на серверной стороне.\n         */\n        this.setState({\n            needRedrawAfterMount: true,\n        });\n\n        if (!this.state.canUseDOM || !this.isContainerReady()) {\n            return;\n        }\n\n        this.setState({\n            needRedrawAfterMount: false,\n        });\n\n        if (!this.isPropsToPositionCorrect()) {\n            throw new Error('Cannot show popup without target or position');\n        }\n\n        if (!this.domElemPopup) {\n            this.domElemPopup = this.popup;\n            this.domElemPopupInner = this.inner;\n            this.domElemPopupContent = this.content;\n        }\n\n        const popupHash = this.getPopupHash();\n        let bestDrawingParams;\n\n        switch (this.props.target) {\n        case 'position':\n            bestDrawingParams = { top: this.position.top, left: this.position.left };\n            break;\n\n        case 'screen':\n            bestDrawingParams = {\n                top: 0,\n                left: 0,\n                right: 0,\n                bottom: 0,\n                overflow: this.inner.scrollHeight > this.inner.clientHeight,\n            };\n            break;\n\n        case 'anchor':\n            bestDrawingParams = calcBestDrawingParams(\n                popupHash,\n                calcTargetDimensions(popupHash),\n                calcFitContainerDimensions(popupHash),\n            );\n            break;\n        }\n\n        this.setState({\n            direction: bestDrawingParams.direction,\n            hasScrollbar: bestDrawingParams.overflow,\n            styles: this.getDrawingCss(bestDrawingParams),\n        });\n\n        this.setGradientStyles();\n    };\n\n    private ensureClickEvent(isDestroy?) {\n        const isNeedBindEvent = isDestroy === undefined ? this.props.visible : !isDestroy;\n\n        // We need timeouts to not to catch the event that causes\n        // popup opening (because it propagates to the `window`).\n        if (this.clickEventBindTimeout) {\n            clearTimeout(this.clickEventBindTimeout);\n            this.clickEventBindTimeout = null;\n        }\n\n        this.clickEventBindTimeout = setTimeout(() => {\n            if (!this.isWindowClickBinded && isNeedBindEvent) {\n                window.addEventListener('click', this.handleWindowClick);\n                window.addEventListener('touchend', this.handleWindowClick);\n                this.isWindowClickBinded = true;\n            } else if (this.isWindowClickBinded && !isNeedBindEvent) {\n                window.removeEventListener('click', this.handleWindowClick);\n                window.removeEventListener('touchend', this.handleWindowClick);\n                this.isWindowClickBinded = false;\n            }\n        }, 0);\n    }\n\n    private getDrawingCss(drawingParams) {\n        return {\n            top: drawingParams.top,\n            left: drawingParams.left,\n            right: drawingParams.right,\n            bottom: drawingParams.bottom,\n            height: this.props.height === 'adaptive' ? drawingParams.height : 'auto',\n        };\n    }\n\n    private getMinWidth() {\n        return this.props.minWidth === undefined ? 0 : this.props.minWidth;\n    }\n\n    private getMaxWidth() {\n        return this.props.maxWidth === undefined ? 'none' : this.props.maxWidth;\n    }\n\n    private getMaxHeight() {\n        return this.props.maxHeight === undefined ? 'none' : this.props.maxHeight;\n    }\n\n    /**\n     * Get collection of popup properties.\n     *\n     */\n    private getPopupHash() {\n        return {\n            directions: this.props.directions,\n            bestDirection: this.state.direction,\n            isHeightAdaptive: this.props.height === 'adaptive',\n            isHeightAvailable: this.props.height === 'available',\n            isTargetAnchor: this.props.target === 'anchor',\n            isHaveTooltip: this.props.type === 'tooltip',\n            width: this.domElemPopup.offsetWidth,\n            height: this.domElemPopup.offsetHeight,\n            contentWidth: this.domElemPopupContent.offsetWidth,\n            contentHeight: this.domElemPopupContent.offsetHeight,\n            offset: {\n                main: this.props.mainOffset,\n                second: this.props.secondaryOffset,\n                fitContainer: this.props.fitContaiterOffset,\n            },\n            targetPosition: this.position,\n            targetAnchor: this.anchor,\n            fitContainer: this.getPositioningContainer(),\n        };\n    }\n\n    private setGradientStyles() {\n        const { clientWidth } = this.inner;\n\n        this.setState({\n            topGradientStyles: {\n                width: clientWidth,\n                height: 0,\n            },\n            bottomGradientStyles: {\n                width: clientWidth,\n            },\n        });\n    }\n}\n\nexport default withTheme<PopupProps, Popup>(Popup);\n"]}