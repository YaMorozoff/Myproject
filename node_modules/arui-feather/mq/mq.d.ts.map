{"version":3,"sources":["mq/mq.tsx"],"names":[],"mappings":"AAIA,OAAO,KAAK,MAAM,OAAO,CAAC;AAO1B,oBAAY,OAAO,GAAG;IAElB;;OAEG;IACH,KAAK,CAAC,EAAE,MAAM,CAAC;IAEf;;OAEG;IACH,KAAK,CAAC,EAAE,OAAO,CAAC;IAEhB;;OAEG;IACH,QAAQ,CAAC,EAAE,KAAK,CAAC,SAAS,CAAC;IAE3B;;OAEG;IACH,aAAa,CAAC,EAAE,CAAC,SAAS,CAAC,EAAE,OAAO,KAAK,IAAI,CAAC;CACjD,CAAC;AAEF,aAAK,OAAO,GAAG;IACX,SAAS,EAAE,OAAO,CAAC;CACtB,CAAA;AAED;;;;;;GAMG;AACH,cAAM,EAAG,SAAQ,KAAK,CAAC,SAAS,CAAC,OAAO,EAAE,OAAO,CAAC;IAC9C,KAAK;;MAEH;IAEF,OAAO,CAAC,GAAG,CAA+B;IAE1C,iBAAiB;IAMjB,oBAAoB;IAMpB,MAAM;IAQN,OAAO,CAAC,WAAW,CAoBlB;CACJ;AAED,eAAe,EAAE,CAAC","file":"mq.d.ts","sourcesContent":["/* This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport { getMatchMedia, releaseMatchMedia } from '../lib/match-media';\nimport { isPointerEventsSupported, isTouchSupported } from './utils';\n\nconst IS_BROWSER = typeof window !== 'undefined';\nconst SUPPORTS_TOUCH = IS_BROWSER && (isPointerEventsSupported() || isTouchSupported());\n\nexport type MqProps = {\n\n    /**\n     * Медиа запрос\n     */\n    query?: string;\n\n    /**\n     * Запрос на поддержку тач-событий\n     */\n    touch?: boolean;\n\n    /**\n     * Дочерние элементы `Mq`\n     */\n    children?: React.ReactNode;\n\n    /**\n     * Обработчик изменений в совпадении запросов\n     */\n    onMatchChange?: (isMatched?: boolean) => void;\n};\n\ntype MqState = {\n    isMatched: boolean;\n}\n\n/**\n * Компонент, имплементирующий поддержку медиа запросов в шаблонах.\n * Рендерит внутренние компоненты/разметку исходя из соответствия условиям запроса.\n * Для `query` используется window.matchMedia с полифиллом для IE9.\n * Можно использовать кастомные запросы из `src/mq/mq.json`, например `--small`.\n * Пока браузеры не поддерживают CSS4 Media Queries, поддержка тач-событий определяется через `touch`.\n */\nclass Mq extends React.Component<MqProps, MqState> {\n    state = {\n        isMatched: false,\n    };\n\n    private mql: MediaQueryList | null = null;\n\n    componentDidMount() {\n        this.mql = getMatchMedia(this.props.query);\n        this.mql.addListener(this.handleMatch);\n        this.handleMatch(this.mql);\n    }\n\n    componentWillUnmount() {\n        releaseMatchMedia(this.props.query);\n        this.mql.removeListener(this.handleMatch);\n        this.mql = null;\n    }\n\n    render() {\n        if (!this.props.children || !IS_BROWSER || !this.state.isMatched) {\n            return false;\n        }\n\n        return this.props.children;\n    }\n\n    private handleMatch = (mql: MediaQueryList | MediaQueryListEvent) => {\n        let queryPass = true;\n        let touchPass = true;\n\n        if (this.props.query) {\n            queryPass = mql.matches;\n        }\n        if (this.props.touch) {\n            touchPass = SUPPORTS_TOUCH;\n        } else if (this.props.touch === false) {\n            touchPass = !SUPPORTS_TOUCH;\n        }\n\n        this.setState({\n            isMatched: (queryPass && touchPass),\n        }, () => {\n            if (this.props.onMatchChange) {\n                this.props.onMatchChange(this.state.isMatched);\n            }\n        });\n    }\n}\n\nexport default Mq;\n"]}