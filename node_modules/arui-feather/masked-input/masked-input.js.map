{"version":3,"sources":["masked-input/masked-input.tsx"],"names":[],"mappings":"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","file":"masked-input.js","sourcesContent":["/* This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\n\nimport Mask, { FormatCharacters } from './mask';\n\n// В эту проверку попадают IE9 и IE10, которые не могут корректно работать с кареткой на событии `input`.\nconst IS_IE9_10 = typeof window !== 'undefined' && !!(window as any).ActiveXObject;\n\nconst IS_ANDROID = typeof window !== 'undefined' && /(android)/i.test(window.navigator.userAgent);\n\n/**\n * Возвращает версию андроида в формате \"4.2.1\" или false, если не андроид.\n */\nexport function getAndroidVersion(): string | false {\n    if (!/android/.test(navigator.userAgent.toLowerCase())) {\n        return false;\n    }\n\n    const userAgent = navigator.userAgent.toLowerCase();\n    const match = userAgent.match(/android\\s([\\d.]*)/);\n\n    return match ? match[1] : false;\n}\n\n// Для IE11 вместо `onChange`, используем событие `onInput`, для правильной работы copy/paste\n// Issue на ошибку в React: https://github.com/facebook/react/issues/7211\n// Детектим IE11: `Object.hasOwnProperty.call(window, 'ActiveXObject') && !window.ActiveXObject;`\nconst IS_IE11 = typeof window !== 'undefined' && Object.hasOwnProperty.call(window, 'ActiveXObject') && !(window as any).ActiveXObject;\n\n// Типы операции, которые пользователь может производить с текстовым полем.\nconst operationType = {\n    ADD: 0,\n    DELETE: 1,\n    REPLACE: 2,\n};\n\n/**\n * Возвращает количество не редактируемых символов в строке, в соответствии с указанной маской.\n */\nconst getSeparatorsAmount = (str: string, mask: Mask): number => (\n    str.split('').reduce((amount, _char, index) => {\n        if (mask.isEditableIndex(index)) {\n            return amount;\n        }\n\n        return amount + 1;\n    }, 0)\n);\n\nexport type MaskedInputProps = {\n    /**\n     * Маска для поля ввода, использует формат https://github.com/insin/inputmask-core\n     */\n    mask: string;\n\n    /**\n     * Кастомные форматтеры символов маски, использует формат formatCharacters из `inputmask-core`\n     */\n    formatCharacters?: FormatCharacters;\n\n    /**\n     * Максимальное число символов\n     */\n    maxLength?: number;\n\n    /**\n     * Обработчик, вызываемый перед началом ввода в поле\n     */\n    onProcessInputEvent?: (event?: React.ChangeEvent<any>) => void;\n\n    /**\n     * Признак что пробелы удалять не надо\n     */\n    useWhitespaces?: boolean;\n\n    /**\n     * Идентификатор для систем автоматизированного тестирования\n     */\n    'data-test-id'?: string;\n\n    /**\n     * Содержимое поля ввода\n     */\n    value?: string;\n\n    /**\n     * Обработчик события, вызываемый при событии 'change'\n     */\n    onChange?: (event?: React.ChangeEvent<any>) => void;\n\n    /**\n     * Обработчик события, вызываемый при событии 'input'\n     */\n    onInput?: (event?: React.ChangeEvent<any>) => void;\n\n    /**\n     * Обработчик события, вызываемый при событии 'beforeInput'\n     */\n    onBeforeInput?: (event?: React.FormEvent<any>) => void;\n};\n\n/**\n * Компонент поля ввода с поддержкой масок.\n * Расширяет стандартный <input /> React-а.\n */\nclass MaskedInput extends React.PureComponent<MaskedInputProps> {\n    // TODO [issues/1018] на private ругается\n    input: HTMLInputElement;\n\n    private maskPattern: string;\n\n    private mask: Mask;\n\n    private beforeChangeMask: Mask;\n\n    private formatCharacters: FormatCharacters;\n\n    private value = '';\n\n    private caretFixTimeout: ReturnType<typeof setTimeout> = null;;\n\n    private beforeInputSelection = { start: 0, end: 0 };\n\n    // eslint-disable-next-line camelcase\n    UNSAFE_componentWillMount() {\n        this.setMask(this.props.mask, this.props.formatCharacters, this.props.useWhitespaces);\n        this.beforeChangeMask = this.mask;\n        this.value = this.mask.format(this.props.value || '');\n    }\n\n    // eslint-disable-next-line camelcase\n    UNSAFE_componentWillReceiveProps(nextProps) {\n        let reformatValue = false;\n\n        this.beforeChangeMask = this.mask;\n\n        if (this.props.mask !== nextProps.mask || this.props.formatCharacters !== nextProps.formatCharacters) {\n            this.setMask(nextProps.mask, nextProps.formatCharacters, nextProps.useWhitespaces);\n            reformatValue = true;\n        }\n\n        if (reformatValue || this.props.value !== nextProps.value) {\n            this.value = this.mask.format(nextProps.value || '');\n        }\n    }\n\n    componentWillUnmount() {\n        if (this.caretFixTimeout) {\n            clearTimeout(this.caretFixTimeout);\n            this.caretFixTimeout = null;\n        }\n    }\n\n    render() {\n        const props = { ...this.props };\n\n        delete props.mask;\n        delete props.formatCharacters;\n        delete props.onProcessInputEvent;\n        delete props.useWhitespaces;\n\n        return (\n            <input\n                { ...props }\n                ref={ (ref) => {\n                    this.input = ref;\n                } }\n                value={ this.value }\n                onBeforeInput={ this.handleBeforeInput }\n                onInput={ this.handleInput }\n                onChange={ this.handleChange }\n            />\n        );\n    }\n\n    private handleBeforeInput = (event) => {\n        this.beforeInputSelection = {\n            start: this.input.selectionStart,\n            end: this.input.selectionEnd,\n        };\n\n        if (this.props.onBeforeInput) {\n            this.props.onBeforeInput(event);\n        }\n    };\n\n    /**\n     * Обрабатывает событие «input».\n     *\n     * @param event The Event object\n     */\n    private handleInput = (event: React.ChangeEvent<HTMLInputElement>) => {\n        const processedEvent = IS_IE9_10 ? event : this.processInputEvent(event);\n\n        if (this.props.onInput) {\n            this.props.onInput(processedEvent);\n        }\n\n        if (IS_IE11) {\n            if (this.props.onChange) {\n                this.props.onChange(processedEvent);\n            }\n        }\n    };\n\n    /**\n     * Обрабатывает событие «change».\n     *\n     * @param event The Event object\n     */\n    private handleChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n        if (IS_IE11 || !this.props.onChange) {\n            return;\n        }\n\n        const processedInput = IS_IE9_10 ? this.processInputEvent(event) : event;\n\n        if (this.props.onChange) {\n            this.props.onChange(processedInput);\n        }\n    };\n\n    /**\n     * Устанавливает фокус на поле ввода.\n     */\n    public focus() {\n        this.input.focus();\n    }\n\n    /**\n     * Снимает фокус с поля ввода.\n     */\n    public blur() {\n        this.input.blur();\n    }\n\n    /**\n     * Возвращает ссылку на HTMLElement инпута.\n     */\n    public getControl() {\n        return this.input;\n    }\n\n    /**\n     * Синхронно обновляет маску на поле ввода.\n     *\n     * @param newMask Новая маска\n     * @param formatCharacters Форматтер маски\n     * @param useWhitespaces использовать в маске пробелы\n     */\n    public setMask(newMask: string, formatCharacters: FormatCharacters, useWhitespaces?: boolean) {\n        if (this.maskPattern !== newMask || this.formatCharacters !== formatCharacters) {\n            this.mask = new Mask(newMask, formatCharacters, useWhitespaces);\n            this.maskPattern = newMask;\n            this.formatCharacters = formatCharacters;\n        }\n    }\n\n    // eslint-disable-next-line complexity\n    private processInputEvent(event) {\n        if (this.props.onProcessInputEvent) {\n            this.props.onProcessInputEvent(event);\n        }\n\n        const prevSelection = this.input.selectionStart;\n        const newValue = event.target.value;\n\n        const currentValue = this.value;\n        const formattedValue = this.mask.format(newValue);\n\n        this.value = formattedValue;\n        // eslint-disable-next-line no-param-reassign\n        event.target.value = formattedValue;\n\n        // Если изменение поля ввода произошло не в конце ввода,\n        // то необходимо починить стандартное поведение Реакта и\n        // вернуть каретку к последнему изменению.\n        if (prevSelection <= currentValue.length) {\n            let newSelection = prevSelection;\n\n            // Определяем тип операции, который был произведен над текстовым полем.\n            let opType = newValue.length >= currentValue.length ? operationType.ADD : operationType.DELETE;\n\n            // На пользовательском инпуте было выделение перед операцией,\n            // значит могла быть операция или удаления или замены.\n            const beforeInputSelectionLength = this.beforeInputSelection.end - this.beforeInputSelection.start;\n\n            if (beforeInputSelectionLength >= 1) {\n                if (newValue.length !== currentValue.length - beforeInputSelectionLength) {\n                    opType = operationType.REPLACE;\n                }\n            }\n\n            const beforeChangeSeparatorsAmount = getSeparatorsAmount(\n                currentValue.slice(0, prevSelection),\n                this.beforeChangeMask,\n            );\n\n            const afterChangeSeparatorsAmount = getSeparatorsAmount(\n                formattedValue.slice(0, newSelection),\n                this.mask,\n            );\n\n            // Двигаем каретку вправо, если слева от каретки добавились не редактируемые символы\n            const shouldShiftCaret = beforeChangeSeparatorsAmount < afterChangeSeparatorsAmount\n                && (opType === operationType.ADD || opType === operationType.REPLACE)\n                && this.beforeChangeMask.isEditableIndex(this.beforeInputSelection.start)\n                && this.mask.isEditableIndex(newSelection);\n\n            // Двигаем каретку влево, если слева от каретки добавились не редактируемые символы\n            const shouldUnshiftCaret = beforeChangeSeparatorsAmount > afterChangeSeparatorsAmount\n                && opType === operationType.DELETE\n                && (this.mask.isEditableIndex(newSelection - 1) && newSelection > 0);\n\n            if (shouldUnshiftCaret || shouldShiftCaret) {\n                newSelection += (afterChangeSeparatorsAmount - beforeChangeSeparatorsAmount);\n            }\n\n            // Для операции добавления и замены, если мы стояли на нередактируемом символе,\n            // то добавляем сдвиг до ближайшего редактируемого.\n            if (opType === operationType.ADD || opType === operationType.REPLACE) {\n                let index = this.beforeInputSelection.start;\n\n                while (!this.beforeChangeMask.isEditableIndex(index) && index < formattedValue.length) {\n                    index += 1;\n                }\n                newSelection += index - this.beforeInputSelection.start;\n            }\n\n            // Если вдруг попали на нередактируемый символ маски,\n            // то подвигаем курсом до ближайшего редактируемого.\n            if (opType === operationType.ADD || opType === operationType.REPLACE) {\n                while (!this.mask.isEditableIndex(newSelection) && newSelection < formattedValue.length) {\n                    newSelection += 1;\n                }\n            } else if (opType === operationType.DELETE) {\n                while (!this.mask.isEditableIndex(newSelection - 1) && newSelection > 0) {\n                    newSelection -= 1;\n                }\n            }\n\n            // Положение каретки с учетом первого и последнего редактируемого символа маски.\n            const clampedSection = this.clampSelection(newSelection);\n\n            // Фикс бага смещения каретки в браузере на андроидах Jelly Bean (c 4.1 по 4.3)\n            const offsetSection = opType === operationType.ADD\n                && IS_ANDROID && parseFloat(getAndroidVersion() as string) < 4.4 ? 1 : 0;\n\n            this.setInputSelection(clampedSection + offsetSection);\n        } else if (IS_ANDROID) {\n            // Если изменение поля произошло в конце ввода.\n            // Android chrome имеет дефект с автоматической установкой каретки\n            // при использовании клавиатуры отличной от type=\"text\".\n            this.setInputSelectionByTimeout(event.target.selectionStart);\n        }\n\n        return event;\n    }\n\n    /**\n     * Возвращает положение каретки с учетом первого и последнего редактируемого символа маски.\n     *\n     * @param selection Положение каретки\n     */\n    private clampSelection(selection: number) {\n        if (selection < this.mask.firstEditableIndex) {\n            return this.mask.firstEditableIndex;\n        }\n\n        // +1 разрешает каретке становится в конец поля ввода при необходимости.\n        if (selection > this.mask.lastEditableIndex + 1) {\n            return this.mask.lastEditableIndex + 1;\n        }\n\n        return selection;\n    }\n\n    /**\n     * Устанавливает каретку поля ввода в новую позицию.\n     *\n     * @param selection Новое положение каретки\n     */\n    private setInputSelection(selection: number) {\n        this.input.selectionStart = selection;\n        this.input.selectionEnd = selection;\n\n        // IE10 не умеет синхронно в событие `change` переставлять каретку.\n        // Android chrome имеет дефект с автоматической установкой каретки\n        // при использовании клавиатуры отличной от type=\"text\".\n        if (IS_IE9_10 || IS_ANDROID) {\n            this.setInputSelectionByTimeout(selection);\n        }\n    }\n\n    /**\n     * Устанавливает каретку поля ввода в заданную позицию асинхронно.\n     *\n     * Во-избежание дефекта с установкой каретки, наблюдаемом в мобильных браузерах, а так же\n     * браузерах IE9-10, установка происходит асинхронно, с минимальной задержкой,\n     * с помощью [setTimeout] обертки.\n     *\n     * @param selection Положение каретки\n     */\n    private setInputSelectionByTimeout(selection: number) {\n        if (this.caretFixTimeout) {\n            clearTimeout(this.caretFixTimeout);\n            this.caretFixTimeout = null;\n        }\n\n        this.caretFixTimeout = setTimeout(() => {\n            this.caretFixTimeout = null;\n            this.input.selectionStart = selection;\n            this.input.selectionEnd = selection;\n        }, 0);\n    }\n}\n\nexport default MaskedInput;\n"]}