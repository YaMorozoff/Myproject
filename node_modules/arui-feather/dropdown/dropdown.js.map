{"version":3,"sources":["dropdown/dropdown.tsx"],"names":[],"mappings":"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","file":"dropdown.js","sourcesContent":["/* This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport { createCn } from 'bem-react-classname';\nimport { withTheme } from '../cn';\n\nimport Button from '../button/button';\nimport Link from '../link/link';\nimport Popup, { PopupProps } from '../popup/popup';\n\nimport { POPUP_MAIN_OFFSET } from '../vars';\n\nexport type DropdownProps = {\n\n    /**\n     * Тип компонента\n     */\n    switcherType?: 'link' | 'button';\n\n    /**\n     * Текст кнопки компонента\n     */\n    switcherText?: React.ReactNode;\n\n    /**\n     * Компонент [Popup](#!/Popup)\n     */\n    popupContent?: React.ReactNode;\n\n    /**\n     * Свойства для компонента [Popup](#!/Popup)\n     */\n    popupProps?: PopupProps;\n\n    /**\n     * Управление возможностью отображать попап при наведении курсора\n     */\n    mode?: 'hover' | 'normal';\n\n    /**\n     * Управление возможностью открытия попапа\n     */\n    disabled?: boolean;\n\n    /**\n     * Управление состоянием открыт/закрыт попапа\n     */\n    opened?: boolean;\n\n    /**\n     * Только для switcherType='button'. Тип переключателя для кнопки, 'check'\n     */\n    togglable?: 'button' | 'check';\n\n    /**\n     * Размер компонента\n     */\n    size?: 's' | 'm' | 'l' | 'xl';\n\n    /**\n     * Дочерние элементы `Dropdown`\n     */\n    children?: React.ReactNode;\n\n    /**\n     * Тема компонента\n     */\n    theme?: 'alfa-on-color' | 'alfa-on-white';\n\n    /**\n     * Дополнительный класс\n     */\n    className?: string;\n\n    /**\n     * Идентификатор компонента в DOM\n     */\n    id?: string;\n\n    /**\n     * Обработчик клика по кнопке компонента\n     */\n    onSwitcherClick?: (isOpened?: boolean) => void;\n\n    /**\n     * Обработчик события наведения курсора на кнопку компонента\n     */\n    onSwitcherMouseEnter?: (event?: React.MouseEvent<any>) => void;\n\n    /**\n     * Обработчик события снятия курсора с кнопки компонента\n     */\n    onSwitcherMouseLeave?: (event?: React.MouseEvent<any>) => void;\n\n    /**\n     * Обработчик события наведения курсора на попап\n     */\n    onPopupMouseEnter?: (event?: React.MouseEvent<any>) => void;\n\n    /**\n     * Обработчик события снятия курсора с попапа\n     */\n    onPopupMouseLeave?: (event?: React.MouseEvent<any>) => void;\n\n    /**\n     * Обработчик события клика попапа за пределами попапа\n     */\n    onPopupClickOutside?: (event?: React.MouseEvent<any>) => void;\n\n    /**\n     * Идентификатор для систем автоматизированного тестирования\n     */\n    'data-test-id'?: string;\n};\n\n/**\n * Компонент «выпадашка»: ссылка или кнопка. По клику показывается Popup.\n */\nexport class Dropdown extends React.PureComponent<DropdownProps> {\n    protected cn = createCn('dropdown');\n\n    static defaultProps: Partial<DropdownProps> = {\n        switcherType: 'link',\n        switcherText: 'Switcher',\n        disabled: false,\n        popupProps: {\n            target: 'anchor',\n        },\n        size: 'm',\n    };\n\n    state = {\n        opened: false,\n        switcherHovered: false,\n        popupHovered: false,\n    };\n\n    private popup;\n\n    private switcher;\n\n    componentDidMount() {\n        this.popup.setTarget(this.switcher.getNode());\n    }\n\n    render() {\n        return (\n            <div\n                className={ this.cn() }\n                id={ this.props.id }\n                data-test-id={ this.props['data-test-id'] }\n            >\n                { this.renderSwitcher() }\n                { this.renderPopup() }\n            </div>\n        );\n    }\n\n    renderSwitcher() {\n        const content = this.props.children || this.props.switcherText;\n        const opened = this.props.opened === undefined ? this.state.opened : this.props.opened;\n\n        return this.props.switcherType === 'button'\n            ? this.renderSwitcherButton(content, opened)\n            : this.renderSwitcherLink(content);\n    }\n\n    renderSwitcherButton(content, opened) {\n        return (\n            <Button\n                className={ this.cn('switcher') }\n                size={ this.props.size }\n                ref={ (switcher) => {\n                    this.switcher = switcher;\n                } }\n                disabled={ this.props.disabled }\n                togglable={ this.props.togglable as any /** TODO: разобраться детально */ }\n                checked={ this.props.togglable === 'check' && opened }\n                onClick={ this.props.disabled ? undefined : this.handleSwitcherClick }\n                onMouseEnter={ this.handleSwitcherMouseEnter }\n                onMouseLeave={ this.handleSwitcherMouseLeave }\n            >\n                { content }\n            </Button>\n        );\n    }\n\n    renderSwitcherLink(content) {\n        return (\n            <Link\n                className={ this.cn('switcher') }\n                size={ this.props.size }\n                ref={ (switcher) => {\n                    this.switcher = switcher;\n                } }\n                disabled={ this.props.disabled }\n                pseudo={ true }\n                text={ content }\n                onClick={ this.props.disabled ? undefined : this.handleSwitcherClick }\n                onMouseEnter={ this.handleSwitcherMouseEnter }\n                onMouseLeave={ this.handleSwitcherMouseLeave }\n            />\n        );\n    }\n\n    renderPopup() {\n        let mainOffset;\n        const opened = this.props.opened === undefined ? this.state.opened : this.props.opened;\n\n        if (this.props.popupProps === undefined || (\n            this.props.popupProps && this.props.popupProps.type !== 'tooltip')) {\n            switch (this.props.size) {\n            case 's':\n            case 'm': mainOffset = POPUP_MAIN_OFFSET / 2; break;\n            case 'l':\n            case 'xl': mainOffset = POPUP_MAIN_OFFSET; break;\n            }\n        }\n\n        const popupProps = {\n            className: this.cn('popup'),\n            size: this.props.size,\n            mainOffset,\n            ...this.props.popupProps,\n        };\n\n        return (\n            <Popup\n                { ...popupProps }\n                ref={ (popup) => {\n                    this.popup = popup;\n                } }\n                visible={\n                    (!this.props.disabled && opened)\n                    || (this.props.mode === 'hover' && (this.state.switcherHovered || this.state.popupHovered))\n                }\n                onMouseEnter={ this.handlePopupMouseEnter }\n                onMouseLeave={ this.handlePopupMouseLeave }\n                onClickOutside={ this.handlePopupClickOutside }\n            >\n                { this.props.popupContent }\n            </Popup>\n        );\n    }\n\n    private handleSwitcherClick = () => {\n        // eslint-disable-next-line react/no-access-state-in-setstate\n        const newOpenedStatusValue = this.props.opened === undefined ? !this.state.opened : !this.props.opened;\n\n        this.setState({\n            opened: newOpenedStatusValue,\n        });\n\n        if (this.props.onSwitcherClick) {\n            this.props.onSwitcherClick(newOpenedStatusValue);\n        }\n    };\n\n    private handleSwitcherMouseEnter = (event) => {\n        this.setState({ switcherHovered: true });\n\n        if (this.props.onSwitcherMouseEnter) {\n            this.props.onSwitcherMouseEnter(event);\n        }\n    };\n\n    private handleSwitcherMouseLeave = (event) => {\n        this.setState({ switcherHovered: false });\n\n        if (this.props.onSwitcherMouseLeave) {\n            this.props.onSwitcherMouseLeave(event);\n        }\n    };\n\n    private handlePopupMouseEnter = (event) => {\n        this.setState({ popupHovered: true });\n\n        if (this.props.onPopupMouseEnter) {\n            this.props.onPopupMouseEnter(event);\n        }\n    };\n\n    private handlePopupMouseLeave = (event) => {\n        this.setState({ popupHovered: false });\n\n        if (this.props.onPopupMouseLeave) {\n            this.props.onPopupMouseLeave(event);\n        }\n    };\n\n    private handlePopupClickOutside = (event) => {\n        this.setState({ opened: false });\n\n        if (this.props.onPopupClickOutside) {\n            this.props.onPopupClickOutside(event);\n        }\n    }\n}\n\nexport default withTheme<DropdownProps, Dropdown>(Dropdown);\n"]}