{"version":3,"sources":["performance.ts"],"names":[],"mappings":"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","file":"performance.js","sourcesContent":["/* This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\nimport { isValidElement } from 'react';\n\ninterface ClassDecorator {\n    <TFunction extends Function>(target: TFunction): TFunction | void;\n}\n\nconst { hasOwnProperty } = Object.prototype;\n\n/**\n * Функции проверки равенства двух переменных.\n *\n * @param {*} valueA Первое значение\n * @param {*} valueB Второе значение\n * @param {Boolean} [deep=false] Запускать ли глубокую проверку равенства\n * @returns {Boolean}\n */\nexport function isEqual(valueA: unknown, valueB: unknown, deep = false): boolean {\n    if (Object.is(valueA, valueB)) {\n        return true;\n    }\n\n    if (!isObject(valueA) || !isObject(valueB)) {\n        return false;\n    }\n\n    if (Object.getPrototypeOf(valueA) !== Object.getPrototypeOf(valueB)) {\n        return false;\n    }\n\n    const keysA = Object.keys(valueA);\n    const keysB = Object.keys(valueB);\n\n    if (keysA.length !== keysB.length) {\n        return false;\n    }\n\n    const bHasOwnProperty = hasOwnProperty.bind(valueB);\n\n    while (keysA.length > 0) {\n        const key = keysA.pop();\n\n        if (!bHasOwnProperty(key)) {\n            return false;\n        }\n\n        const a = valueA[key];\n        const b = valueB[key];\n\n        if (!Object.is(a, b)) {\n            if (!deep || !isObject(a) || !isObject(b)) {\n                return false;\n            }\n\n            // https://github.com/erikras/redux-form/issues/3461\n            // https://github.com/erikras/redux-form/pull/3481\n            if (isValidElement(a) || isValidElement(b)) {\n                return false;\n            }\n\n            if (!isEqual(a, b, deep)) {\n                return false;\n            }\n        }\n    }\n\n    return true;\n\n    function isObject(value: unknown): value is {} {\n        return typeof value === 'object' && value !== null;\n    }\n}\n\n/**\n * Поверхностная проверка равенства props и state компонента.\n *\n * @param {*} nextProps next component props\n * @param {*} nextState next component state\n * @param {*} nextContext next component context\n * @returns {Boolean}\n */\nfunction shallow<P, S>(nextProps: Readonly<P>, nextState: Readonly<S>, nextContext: unknown): boolean {\n    return !isEqual(this.props, nextProps)\n        || !isEqual(this.state, nextState)\n        || !isEqual(this.context, nextContext);\n}\n\n/**\n * Запускает глубокую проверку равенства props и state компонента.\n * Глубокая проверка менее производительна, но позволяет проверять равенство массивов и объектов.\n *\n * @param {*} nextProps next component props\n * @param {*} nextState next component state\n * @param {*} nextContext next component context\n * @returns {Boolean}\n */\nfunction deep<P, S>(nextProps: Readonly<P>, nextState: Readonly<S>, nextContext: unknown): boolean {\n    return !isEqual(this.props, nextProps, true)\n        || !isEqual(this.state, nextState, true)\n        || !isEqual(this.context, nextContext, true);\n}\n\n/**\n * Декоратор для улучшения производительности React компонентов. Работает за счет реализации метода\n * [shouldComponentUpdate](https://facebook.github.io/react/docs/advanced-performance.html#avoiding-reconciling-the-dom)\n *\n * У декоратора есть два режима работы - глубокая и \"поверхностная\" проверка. В случае, если все props и state\n * компонента состоит только из примитивных значений (`number`, `string`, `null`, `undefined`) стоит использовать\n * поверхностную проверку, которая будет проверять простое равенство значений в `props` и `state`.\n\n * В случае, если props или state компонентов имеют сложную структуру (массивы, объекты) необходимо использовать\n * глубокую проверку.\n *\n * @param useDeep Использовать глубокую проверку равенства\n * @deprecated since version 17.0.0\n */\nexport default function performance(useDeep = false): ClassDecorator {\n    if (!useDeep) {\n        console.warn('arui-feather/performance is deprecated.');\n    }\n\n    return function (target) {\n        // eslint-disable-next-line no-param-reassign\n        target.prototype.shouldComponentUpdate = useDeep ? deep : shallow;\n    };\n}\n"]}