{"version":3,"sources":["swipeable/swipeable.tsx"],"names":[],"mappings":"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","file":"swipeable.js","sourcesContent":["import React from 'react';\n\n// TODO: функция вызывается на TouchEvent и PointerEvent хотя больше от этого путанницы\n// Тут надо отдельно рефачить и типы и имплементацию чтоб ничего не сломать\nexport const getCoordinates = ({\n    touches, changedTouches, clientX, clientY,\n}: Partial<TouchEvent & PointerEvent>) => (\n    (touches && changedTouches)\n        ? { clientX: (touches[0] || changedTouches[0]).clientX, clientY: (touches[0] || changedTouches[0]).clientY }\n        : { clientX, clientY }\n);\n\nexport type SwipeableProps = {\n\n    /**\n     * Число пикселей, на которое нужно сместиться, чтобы запустить функцию по свайпу\n     */\n    delta?: number;\n\n    /**\n     * Функция запускаемая по свайпу.\n     */\n    onSwipe: (direction: 'top' | 'right' | 'bottom' |'left') => void;\n\n    /**\n     * Дочерний компонент представленный в виде единичного элемента\n     * TODO: // тут должны быть такие children что у ниъ есть onMouseDown onTouchStart\n     */\n    children: any;\n};\n\nclass Swipeable extends React.PureComponent<SwipeableProps> {\n    static defaultProps: Partial<SwipeableProps> = {\n        delta: 100,\n    };\n\n    swipeStartX = 0;\n\n    swipeStartY = 0;\n\n    deltaX = 0;\n\n    deltaY = 0;\n\n    componentWillUnmount() {\n        this.removeListeners();\n    }\n\n    render() {\n        return React.cloneElement(this.props.children, {\n            onMouseDown: this.handleMouseDown,\n            onTouchStart: this.handleTouchStart,\n        });\n    }\n\n    private handleMouseDown = (event) => {\n        if (this.props.children.props.onMouseDown) {\n            this.props.children.props.onMouseDown(event);\n        }\n\n        this.handleSwipeStart(event);\n\n        document.addEventListener('mouseup', this.handleSwipeEnd);\n        document.addEventListener('mouseup', this.removeListeners);\n    };\n\n    private handleTouchStart = (event) => {\n        if (event.touches && event.touches.length > 1) {\n            return;\n        }\n\n        if (this.props.children.props.onTouchStart) {\n            this.props.children.props.onTouchStart(event);\n        }\n\n        this.handleSwipeStart(event);\n\n        document.addEventListener('touchend', this.handleSwipeEnd);\n        document.addEventListener('touchend', this.removeListeners);\n        document.addEventListener('touchcancel', this.removeListeners);\n    };\n\n    private handleSwipeStart = (event) => {\n        const { clientX, clientY } = getCoordinates(event);\n\n        this.swipeStartX = clientX;\n        this.swipeStartY = clientY;\n    };\n\n    private handleSwipeEnd = (event) => {\n        const { props: { delta, onSwipe } } = this;\n        const { clientX, clientY } = getCoordinates(event);\n\n        this.deltaX = this.swipeStartX - clientX;\n        this.deltaY = this.swipeStartY - clientY;\n\n        if (typeof onSwipe === 'function') {\n            if (this.deltaX > delta) {\n                onSwipe('left');\n            } else if (this.deltaX < -delta) {\n                onSwipe('right');\n            } else if (this.deltaY > delta) {\n                onSwipe('top');\n            } else if (this.deltaY < -delta) {\n                onSwipe('bottom');\n            }\n        }\n    };\n\n    private removeListeners = () => {\n        document.removeEventListener('mouseup', this.handleSwipeEnd);\n        document.removeEventListener('mouseup', this.removeListeners);\n        document.removeEventListener('touchend', this.handleSwipeEnd);\n        document.removeEventListener('touchend', this.removeListeners);\n        document.removeEventListener('touchcancel', this.removeListeners);\n        this.swipeStartX = 0;\n        this.swipeStartY = 0;\n        this.deltaX = 0;\n        this.deltaY = 0;\n    };\n}\n\nexport default Swipeable;\n"]}